---
title: "Regression Analysis"
author: "Embon,Gerbaudo , Iorio, Barttfeld & Solovey"
date: "8/9/2021"
output: html_document
---

## Levantar datos
                                 
```{r levantar datos, echo=TRUE}

# voy a la carpeta del proyecto
root <- rprojroot::is_rstudio_project
basename(getwd())

# load the function to get the df list
source(root$find_file("Analysis/AuxiliaryFunctions/DataFrame_Filtered.R"))

# get the df list
# experimento = completo,survey,sorteo, todos
DF_list <- DataFrame_Filtered(experimento = "todos", 
                                 filtroRT_Disc_Sup = 5000,
                                 filtroRT_Disc_Inf = 200,
                                 filtroRT_Conf_Sup = 5000,
                                 filtroRT_Conf_Inf = 0,
                                 filtroTrial = 20)

# DF_list:
# a = df_total
# b = d.sin.normalizar
# c = d.sin.normalizar.mc.filter
# d = d.mc.filter

df_total <- DF_list$a
d.sin.normalizar <- DF_list$b
d.sin.normalizar.mc.filter <- DF_list$c
d.mc.filter <- DF_list$d 
###############
### library ###
###############
library(arm)
library(dplyr)

###########################
### Regression Analysis ###
###########################

### lineas para hacer regresion 

d1 = d.sin.normalizar.mc.filter

# sujetos que tienen un 85 % de trials en una misma respuesta de confianza
d2 <- d1[d1$sujetos != 7 & d1$sujetos != 72 & d1$sujetos != 84
         & d1$sujetos != 86 & d1$sujetos != 90 & d1$sujetos != 91
         & d1$sujetos != 108 & d1$sujetos != 125 & d1$sujetos != 146
         & d1$sujetos != 169 & d1$sujetos != 1008 & d1$sujetos != 2009
         & d1$sujetos != 2035 & d1$sujetos != 2039 & d1$sujetos != 2040
         & d1$sujetos != 2047 & d1$sujetos != 2067 & d1$sujetos != 2076, ]

# sujetos que tienen menos de 70 de trials
d3 <- d2[d2$sujetos != 3 & d2$sujetos != 10 & d2$sujetos != 17
         & d2$sujetos != 23 & d2$sujetos != 31 & d2$sujetos != 90
         & d2$sujetos != 99 & d2$sujetos != 103 & d2$sujetos != 109
         & d2$sujetos != 125 & d2$sujetos != 160 & d2$sujetos != 1030
         & d2$sujetos != 1033 & d2$sujetos != 1038 & d2$sujetos != 2009
         & d2$sujetos != 2031 & d2$sujetos != 2033 & d2$sujetos != 2036
         & d2$sujetos != 2009 & d2$sujetos != 2038 & d2$sujetos != 2039
         & d2$sujetos != 2061 & d2$sujetos != 2064 & d2$sujetos != 2067
         & d2$sujetos != 2085, ]

d.mc.filter <-  d.mc.filter %>% 
  filter(d.mc.filter$sujetos %in% d3$sujetos)

d <- d.mc.filter

```

##### Empiezo a correr modelos de regresiones

## Modelo 1
```{r modelo 1, echo=TRUE}

vec_variables_values <- list(d$Anhedonia,
                          d$Anxiousness,
                          d$AttentionSeeking,
                          d$Callousness,
                          d$Deceitfulness,
                          d$Depressivity,
                          d$Distractivility,
                          d$Excentricity,
                          d$EmotionalLability,
                          d$Grandiosity,
                          d$Hostility,
                          d$Impulsivity,
                          d$IntimacyAvoidance,
                          d$Irresponsibility,
                          d$Manipulativeness,
                          d$PerceptualDysregulation,
                          d$Perseveration,
                          d$RestrictedAffectivity,
                          d$RigidPerfeccionism,
                          d$RiskTaking,
                          d$SeparationInsecurity,
                          d$Submissiveness,
                          d$Suspiciousness,
                          d$UnusualBeliefsAndExperiences,
                          d$Withdrawal)


vec_variables_string <- c("Anhedonia",
                   "Anxiousness",
                   "AttentionSeeking",
                   "Callousness",
                   "Deceitfulness",
                   "Depressivity",
                   "Distractivility",
                   "Excentricity",
                   "EmotionalLability",
                   "Grandiosity",
                   "Hostility",
                   "Impulsivity",
                   "IntimacyAvoidance",
                   "Irresponsibility",
                   "Manipulativeness",
                   "PerceptualDysregulation",
                   "Perseveration",
                   "RestrictedAffectivity",
                   "RigidPerfeccionism",
                   "RiskTaking",
                   "SeparationInsecurity",
                   "Submissiveness",
                   "Suspiciousness",
                   "UnusualBeliefsAndExperiences",
                   "Withdrawal")


for (i in 1:length(vec_variables_string)) {
  a <- lm(d3$mc ~ vec_variables_values[[i]] + 
                  d$edad + 
                  #d$Im +
                  d$edad:vec_variables_values[[i]]) #+
                  #d$Im: vec_variables_values[[i]])
  print(vec_variables_string[i])
  print(summary(a))
}

```
## Modelo 2

```{r Modelo 2, echo=TRUE}

vec_variables_values <- list(d$DomainPsychoticism,
                             d$DomainDisinhibition,
                             d$DomainAntagonism,
                             d$DomainDetachment,
                             d$DomainNegativeAffect)


vec_variables_string <- c("DomainPsychoticism",
                          'DomainDisinhibition',
                          'DomainAntagonism',
                          'DomainDetachment',
                          'DomainNegativeAffect')


for (i in 1:length(vec_variables_string)) {
  a <- lm(d3$mc ~ vec_variables_values[[i]] + 
                  d$edad + 
                  #d$Im +
                  d$edad:vec_variables_values[[i]]) #+
                  #d$Im: vec_variables_values[[i]])
  print(vec_variables_string[i])
  print(summary(a))
}

```
