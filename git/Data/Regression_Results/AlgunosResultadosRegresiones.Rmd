---
title: "Algunos resultados de regresiones"
output: html_document
date: '2022-07-12'
---

Librerias
```{r}
#require(gtsummary)
require(dplyr)
library(glmnet)
require(jtools)
require(gtsummary)
```

## Se presentan algunos resultados para buscar bibliograf√≠a al respecto sobre lo que dio

Seteo la ruta del proyecto
```{r}
root <- rprojroot::is_rstudio_project
basename(getwd())  
```

Regresion lineal de dominios para predecir confianza media por sujeto
```{r}
filepath <- root$find_file("git/Tables/Code/Conf_PID_domain_linear_model.RData")
load(file= filepath)
tab
```

Regresion lineal de facetas para predecir confianza media por sujeto
```{r}
filepath <- root$find_file("git/Tables/Code/Conf_PID_facets_linear_model.RData")
load(file= filepath)
tab 
```

Aclaracion: De confianza, no estan aca los resultados de las regresiones lineales univariadas por dominios y facetas.

Regresion lineal de dominios para predecir mc por sujeto
```{r}
filepath <- root$find_file("git/Tables/Code/mc_PID_domain_linear_model.RData")
load(file= filepath)
tab
```

Regresion logistica mixta de dominios para predecir mc por sujeto
```{r}
filepath <- root$find_file("git/Tables/Code/mc_PID_domain_logistic_mixed_model.RData")
load(file= filepath)
tab
```

Regresion lineal de facetas para predecir mc por sujeto
```{r}
filepath <- root$find_file("git/Data/Regression_Results/mc_PID_facets_linear_model.RData")
load(file= filepath)
tab
```

Regresion logistica mixta de facetas para predecir mc por sujeto
```{r}
filepath <- root$find_file("git/Data/Regression_Results/mc_PID_facets_logistic_mixed_model.RData")
load(file= filepath)
tab
```

Regresion lineal - elastic net de facetas para predecir mc por sujeto
```{r echo=FALSE}
filepath <- root$find_file("git/Data/Regression_Results/mc_PID_facets_elasticNet_linear_model.RData")
load(file= filepath)

####### data frame with filters already applied
filepath <- root$find_file("git/Data/df_total_filtered.Rda")
load(file= filepath)

source(root$find_file("git/Analysis/AuxiliaryFunctions/DataFrame_subset.R"))
d <- DataFrame_subset(df_total)

### preprocessing
d$gender <- ifelse(d$gender == "Masculino",1,0)

# transforming the df to a matrix, without a few variables that don't matter
d_mat <- d %>%
  select(!c(Participant,
            DomainNegativeAffect,
            DomainDetachment,
            DomainAntagonism,
            DomainDisinhibition,
            DomainPsychoticism,
            PC,
            ConfMean,
            ConfSD,
            ReacTimeMean_DiscTask,
            ReacTimeSD_DiscTask,
            ReacTimeMean_ConfTask,
            ReacTimeSD_ConfTask,
            mc)) %>%
  data.matrix()

plot(fit, xvar = "lambda", label = TRUE)

plot(fit, xvar = "dev", label = TRUE)

# hago cross validation usando los valores por defectos
set.seed(1010)
cvfit <- cv.glmnet(d_mat, d$mc, type.measure = "mse", nfolds = 10)
print(cvfit)
# ploteo los errores cuadraticos
plot(cvfit)

# elijo el que minimiza el error
cvfit$lambda.min

# veo el modelo con ese lambda
coef(cvfit, s = "lambda.min")
```

Regresion lineal - elastic net de facetas para predecir ConfMean por sujeto
```{r echo=FALSE}
filepath <- root$find_file("git/Data/Regression_Results/Conf_PID_facets_elasticNet_linear_model.RData")
load(file= filepath)

####### data frame with filters already applied
filepath <- root$find_file("git/Data/df_total_filtered.Rda")
load(file= filepath)

source(root$find_file("git/Analysis/AuxiliaryFunctions/DataFrame_subset.R"))
d <- DataFrame_subset(df_total)

### preprocessing
d$gender <- ifelse(d$gender == "Masculino",1,0)

# transforming the df to a matrix, without a few variables that don't matter
d_mat <- d %>%
  select(!c(Participant,
            DomainNegativeAffect,
            DomainDetachment,
            DomainAntagonism,
            DomainDisinhibition,
            DomainPsychoticism,
            PC,
            ConfMean,
            ConfSD,
            ReacTimeMean_DiscTask,
            ReacTimeSD_DiscTask,
            ReacTimeMean_ConfTask,
            ReacTimeSD_ConfTask,
            mc)) %>%
  data.matrix()

plot(fit, xvar = "lambda", label = TRUE)

plot(fit, xvar = "dev", label = TRUE)

# hago cross validation usando los valores por defectos
set.seed(1010)
cvfit <- cv.glmnet(d_mat, d$ConfMean, type.measure = "mse", nfolds = 10)
print(cvfit)
# ploteo los errores cuadraticos
plot(cvfit)

# elijo el que minimiza el error
cvfit$lambda.min

# veo el modelo con ese lambda
coef(cvfit, s = "lambda.min")
```